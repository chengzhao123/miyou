{"version":3,"sources":["webpack:///./src/assets/fourth/womanf.png","webpack:///./src/views/first/chat.vue?3ea3","webpack:///src/views/first/chat.vue","webpack:///./src/views/first/chat.vue?9c5b","webpack:///./src/views/first/chat.vue","webpack:///./src/assets/fourth/manf.png","webpack:///./src/assets/fourth/womans.png","webpack:///./src/views/first/chat.vue?bf4e","webpack:///./node_modules/core-js/modules/es.array.splice.js","webpack:///./src/assets/fourth/mans.png"],"names":["module","exports","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","onRefresh","model","value","callback","$$v","isLoading","expression","_l","listinfo","item","index","remove","_e","key","nativeOn","$event","goChat","style","toTop","slot","imgbox","headimg","src","_v","_s","name","lastMsg","tel","newMsg","indexOf","num","canceltoTop","staticRenderFns","data","loading","list","socket","computed","methods","arr","userInfo","friends","i","info","JSON","parse","localStorage","getItem","length","content","setTimeout","$router","push","path","query","id","cont","a","histel","temp","splice","unshift","status","$socket","emit","mounted","removeAllListeners","res","type","infobg","setItem","checked","message","duration","component","$","toAbsoluteIndex","toInteger","toLength","toObject","arraySpeciesCreate","createProperty","arrayMethodHasSpeciesSupport","arrayMethodUsesToLength","HAS_SPECIES_SUPPORT","USES_TO_LENGTH","ACCESSORS","0","1","max","Math","min","MAX_SAFE_INTEGER","MAXIMUM_ALLOWED_LENGTH_EXCEEDED","target","proto","forced","start","deleteCount","insertCount","actualDeleteCount","A","k","from","to","O","len","actualStart","argumentsLength","arguments","TypeError"],"mappings":"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","file":"assets/js/chunk-39b263fe.js","sourcesContent":["module.exports = __webpack_public_path__ + \"assets/img/womanf.png\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"list-content\",attrs:{\"id\":\"list-content\"}},[_c('van-pull-refresh',{attrs:{\"success-text\":\"刷新成功\"},on:{\"refresh\":_vm.onRefresh},model:{value:(_vm.isLoading),callback:function ($$v) {_vm.isLoading=$$v},expression:\"isLoading\"}},_vm._l((_vm.listinfo()),function(item,index){return (!item.remove)?_c('van-swipe-cell',{key:index,attrs:{\"stop-propagation\":\"\"},nativeOn:{\"click\":function($event){return _vm.goChat(item)}}},[_c('van-cell',{style:({'background': item.toTop ? 'lightgray' : 'white'}),attrs:{\"border\":true}},[_c('template',{slot:\"title\"},[_c('img',{staticClass:\"imgbg\",attrs:{\"src\":_vm.imgbox[item.headimg || 0].src}}),_c('div',{staticClass:\"imgcot\"},[_c('div',[_vm._v(_vm._s(item.name || 0))]),_c('div',{staticClass:\"con\"},[_vm._v(\" \"+_vm._s(_vm.lastMsg(item.tel))+\" \")])])]),_c('template',{slot:\"default\"},[(_vm.newMsg && _vm.newMsg.indexOf(item.tel) != -1)?_c('span',{staticClass:\"dot\"},[_vm._v(_vm._s(_vm.num(item.tel)))]):_vm._e()])],2),_c('template',{slot:\"right\"},[(!item.toTop)?_c('van-button',{attrs:{\"square\":\"\",\"type\":\"primary\",\"text\":\"置顶\"},on:{\"click\":function($event){return _vm.toTop(index)}}}):_vm._e(),(item.toTop)?_c('van-button',{attrs:{\"square\":\"\",\"type\":\"primary\",\"text\":\"取消置顶\"},on:{\"click\":function($event){return _vm.canceltoTop(index)}}}):_vm._e(),(!item.toTop)?_c('van-button',{attrs:{\"square\":\"\",\"type\":\"danger\",\"text\":\"删除\"},on:{\"click\":function($event){return _vm.remove(index)}}}):_vm._e()],1)],2):_vm._e()}),1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"list-content\" id=\"list-content\">\r\n    <van-pull-refresh v-model=\"isLoading\" @refresh=\"onRefresh\" success-text=\"刷新成功\">\r\n      <van-swipe-cell v-for=\"(item, index) in listinfo()\" :key=\"index\" stop-propagation @click.native=\"goChat(item)\" v-if=\"!item.remove\">\r\n        <van-cell :border=\"true\" :style=\"{'background': item.toTop ? 'lightgray' : 'white'}\">\r\n          <template slot=\"title\">\r\n            <img :src=\"imgbox[item.headimg || 0].src\" class=\"imgbg\" />\r\n            <div class=\"imgcot\">\r\n              <div>{{item.name || 0}}</div>\r\n              <div class=\"con\"> {{ lastMsg(item.tel) }} </div>\r\n            </div>\r\n            </template>\r\n            <template slot='default'>\r\n              <span class=\"dot\" v-if=\"newMsg && newMsg.indexOf(item.tel) != -1\">{{ num(item.tel) }}</span>\r\n            </template>\r\n        </van-cell>\r\n        <template slot=\"right\">\r\n          <van-button v-if=\"!item.toTop\" square type=\"primary\" text=\"置顶\" @click=\"toTop(index)\" />\r\n          <van-button v-if=\"item.toTop\" square type=\"primary\" text=\"取消置顶\" @click=\"canceltoTop(index)\" />\r\n          <van-button v-if=\"!item.toTop\" square type=\"danger\" text=\"删除\" @click=\"remove(index)\" />\r\n        </template>\r\n      </van-swipe-cell>\r\n    </van-pull-refresh>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState, mapMutations } from \"vuex\";\r\n\r\nimport { Toast } from \"vant\";\r\nexport default {\r\n  name: \"chat\",\r\n  data() {\r\n    return {\r\n      loading: false, //是否处于加载状态\r\n      isLoading: false, //是否处于下拉刷新状态\r\n      list: [],\r\n      socket: null,\r\n      imgbox: [\r\n        { id: 0, src: require(\"../../assets/fourth/manf.png\") },\r\n        { id: 1, src: require(\"../../assets/fourth/womanf.png\") },\r\n        { id: 2, src: require(\"../../assets/fourth/mans.png\") },\r\n        { id: 3, src: require(\"../../assets/fourth/womans.png\") }\r\n      ]\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapState([\"userInfo\",\"newMsg\",\"newFir\"]),\r\n  },\r\n  methods: {\r\n    ...mapMutations(['clearNewMsg','addNewMsg','changMsg','updateUserInfo']),\r\n    listinfo() {\r\n      var arr = this.userInfo.friends\r\n      return arr\r\n    },\r\n    num(tel) {\r\n      var i = 0;\r\n      for (var i =0 ;i<this.newMsg.length;i++) {\r\n        if(this.newMsg[i].tel == tel) {\r\n          i++\r\n        }\r\n      }\r\n      if( i > 99) {\r\n        return tel = 99 + '+'\r\n      } else {\r\n        return tel = i\r\n      }\r\n    },\r\n    lastMsg(tel) {\r\n      var info = JSON.parse(localStorage.getItem(tel)) || []\r\n      if(info && info.length >0) {\r\n        return info[info.length - 1].content\r\n      }\r\n      return '我们已是好友，开始聊天吧'\r\n    },\r\n    onRefresh() {\r\n      //下拉刷新\r\n      setTimeout(() => {\r\n        this.finished = false;\r\n        this.isLoading = false;\r\n      }, 1500);\r\n    },\r\n    goChat(item) {\r\n      this.$router.push({\r\n        path: '/chatinfo',\r\n        query: {\r\n          id: item\r\n        }\r\n      })\r\n    },\r\n    cont(tel) {\r\n      var a = JSON.parse(localStorage.getItem(tel))\r\n      if(a) {\r\n        return  ( a[a.length - 1].content )\r\n      } else {\r\n        return \r\n      }\r\n    },\r\n    toTop(index) {\r\n      var arr = this.userInfo.friends\r\n      // 置顶\r\n      if(arr[index].toTop == false && arr.length >=2 ) {\r\n        for(var i = 0,a = 0;i<arr.length; i++) {\r\n          if(arr[i].toTop == false) {\r\n            a++\r\n            if(a == 1) {\r\n              arr[index].toTop = true\r\n              var histel = arr[index].tel\r\n              var temp = arr[index]\r\n              arr.splice(index, 1)\r\n              arr.unshift(temp)\r\n               let model = {\r\n                tel: this.userInfo.tel,\r\n                histel: histel,\r\n                status: true,\r\n                data: arr\r\n              }\r\n              this.$socket.emit('toTop', model)\r\n            }\r\n          }\r\n        }\r\n      } else if(arr[index].toTop == false && arr.length < 2 ) {\r\n        // 只有一个好友\r\n          arr[index].toTop = true\r\n          let model = {\r\n            tel: this.userInfo.tel,\r\n            histel: arr[index].tel,\r\n            status: true,\r\n            data: arr\r\n          }\r\n          this.$socket.emit('toTop', model)\r\n        }\r\n    },\r\n    canceltoTop(index) {\r\n      // 取消置顶\r\n      var arr = this.userInfo.friends\r\n      if(arr[index].toTop == true && arr.length >=2 ) {\r\n        for(var i = 0,a = 0, b = 0;i<arr.length; i++) {\r\n          if(arr[i].toTop == false) {\r\n            a++\r\n            if(a == 1) {\r\n              arr[index].toTop = false\r\n              var histel = arr[index].tel\r\n              var temp = arr[index]\r\n              arr.splice(index, 1)\r\n              arr.splice(i, 0 , temp)\r\n              let model = {\r\n                tel: this.userInfo.tel,\r\n                histel: histel,\r\n                status: false,\r\n                data: arr\r\n              }\r\n              this.$socket.emit('toTop', model)\r\n            }\r\n          } else {\r\n              b++\r\n              //全都置顶了\r\n              if(b == arr.length) {\r\n                arr[index].toTop = false\r\n                var histel = arr[index].tel\r\n                var temp = arr[index]\r\n                arr.splice(index, 1)\r\n                arr.push(temp)\r\n                let model = {\r\n                  tel: this.userInfo.tel,\r\n                  histel: histel,\r\n                  status: false,\r\n                  data: arr\r\n                }\r\n                this.$socket.emit('toTop', model)\r\n              }\r\n            }\r\n        }\r\n      } else if(arr[index].toTop == true && arr.length < 2 ) {\r\n        // 只有一个好友\r\n          arr[index].toTop = false\r\n          let model = {\r\n            tel: this.userInfo.tel,\r\n            histel: arr[index].tel,\r\n            status: false,\r\n            data: arr\r\n          }\r\n          this.$socket.emit('toTop', model)\r\n        }\r\n    },\r\n    //删除\r\n    remove(index) {\r\n      var arr = this.list\r\n      arr[index].remove = true\r\n      let model = {\r\n        tel: this.userInfo.tel,\r\n        histel: arr[index].tel,\r\n        status: true\r\n      }\r\n      this.$socket.emit('remove', model)\r\n    }\r\n  },\r\n  mounted() {\r\n    this.$socket.removeAllListeners('agreeFir');\r\n    this.$socket.removeAllListeners('updateInfo');\r\n    this.$socket.removeAllListeners('updateUser');\r\n    this.$socket.removeAllListeners('toTop');\r\n    this.$socket.removeAllListeners('remove');\r\n    this.$socket.removeAllListeners('getMsg');\r\n    this.$socket.removeAllListeners('online');\r\n    this.$socket.removeAllListeners('getFriend');\r\n    this.$socket.removeAllListeners('notGetMsg');\r\n    this.$socket.removeAllListeners('newFirend');\r\n    this.list = this.userInfo.friends;\r\n    // 下线消息\r\n    this.$socket.on('notGetMsg', res => {\r\n      for(var i = 0; i < res.length; i++) {\r\n        if(res[i].histel == this.userInfo.tel) {\r\n          this.addNewMsg(res[i].tel)\r\n          res[i].type = 1\r\n          var infobg = JSON.parse(localStorage.getItem(res[i].tel)) || []\r\n          infobg.push(res[i])\r\n          localStorage.setItem(res[i].tel,JSON.stringify(infobg))\r\n        }\r\n      }\r\n    })\r\n    // 好友申请\r\n    this.$socket.on('getFriend' ,res =>{\r\n      if(res.histel == this.userInfo.tel) {\r\n        this.changMsg(true)\r\n        localStorage.setItem('newFir', true)\r\n        Toast('收到新的好友申请')\r\n      }\r\n    })\r\n    // 下线过程中的好友申请\r\n    this.$socket.on('newFirend', res => {\r\n      var a = 0;\r\n      for(var i = 0; i < res.length; i++) {\r\n        if(res[i].histel == this.userInfo.tel) {\r\n          a++\r\n          if (a == 1) {\r\n            this.changMsg(true)\r\n            localStorage.setItem('newFir', true)\r\n            Toast('收到新的好友申请')\r\n          }\r\n        }\r\n      }\r\n    })\r\n    // 消息(未进入联系人详情)\r\n    this.$socket.on('getMsg', res =>{\r\n      if(res.histel === this.userInfo.tel ) {\r\n          this.addNewMsg(res.tel)\r\n          res.type = 1\r\n          var infobg = JSON.parse(localStorage.getItem(res.tel)) || []\r\n          infobg.push(res)\r\n          localStorage.setItem(res.tel,JSON.stringify(infobg))\r\n        }\r\n    })\r\n    // 用户在线同意\r\n    this.$socket.on('agreeFir', res => {\r\n      if(res.tel == this.userInfo.tel) {\r\n        this.updateUserInfo(res)\r\n      }\r\n    })\r\n    // 用户上线通知\r\n    this.$socket.on('online', res => {\r\n      var checked = localStorage.getItem('checked')\r\n      if(checked == 1) {\r\n        for(var i = 0; i < res.friends.length ; i++) {\r\n          if(res.friends[i].tel == this.userInfo.tel  ) {\r\n            var content = `你的好友 ${res.name} 上线了`\r\n            this.$notify({\r\n              type: 'success',\r\n              message: content,\r\n              duration: 1000\r\n            });\r\n          }\r\n        }\r\n      }\r\n      \r\n    })\r\n    // 用户更新联系人\r\n    this.$socket.on('updateInfo', res => {\r\n      if(res.tel == this.userInfo.tel) {\r\n        this.updateUserInfo(res)\r\n      }\r\n    })\r\n    // 用户更新个人资料\r\n    this.$socket.on('updateUser', res => {\r\n      if(res.tel == this.userInfo.tel) {\r\n        this.updateUserInfo(res)\r\n      }\r\n    })\r\n    // 用户置顶联系人\r\n    this.$socket.on('toTop', res => {\r\n      if(res.tel == this.userInfo.tel) {\r\n        this.updateUserInfo(res)\r\n        this.listinfo()\r\n      }\r\n    })\r\n    // 用户删除聊天人信息\r\n    this.$socket.on('remove', res => {\r\n      if(res.tel == this.userInfo.tel) {\r\n        this.updateUserInfo(res)\r\n        this.listinfo()\r\n      }\r\n    })\r\n  }\r\n}\r\n</script>\r\n<style lang='scss' scoped>\r\n.list-content {\r\n  overflow: scroll;\r\n  background:white;\r\n}\r\n.van-swipe-cell {\r\n    height: 60px;\r\n}\r\n.van-cell {\r\n    padding: 18px 16px !important;\r\n    background: none;\r\n\r\n}\r\n.van-pull-refresh >>> .van-pull-refresh__track {\r\n  height: calc(100vh - 96px) !important;\r\n}\r\n.van-pull-refresh {\r\n  overflow: unset !important;\r\n}\r\n.van-swipe-cell >>> .van-swipe-cell__wrapper {\r\n    height:60px !important;\r\n}\r\n.van-button {\r\n    height:60px !important;\r\n}\r\n.imgbg {\r\n  width:40px;\r\n  height:40px;\r\n  float: left;\r\n}\r\n.imgcot {\r\n  float: left;\r\n  margin-left: 5px;\r\n  margin-top: -4px;\r\n  .con{\r\n    text-overflow:ellipsis;\r\n    white-space:nowrap;\r\n    width: 200px;\r\n    overflow: hidden;\r\n  }\r\n}\r\n.van-cell .van-cell__title {\r\n  flex:  10 !important;\r\n}\r\n.dot{\r\n  width:25px;\r\n  height:25px;\r\n  line-height: 25px;\r\n  text-align: center;\r\n  opacity: 0.7;\r\n  border-radius: 100%;\r\n  vertical-align: middle;\r\n  // margin-top:10px;\r\n  background-color: lightgray;\r\n  font-size: 14px;\r\n  display: table;\r\n  float: right;\r\n  text-align: center;\r\n  color: white;\r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./chat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./chat.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./chat.vue?vue&type=template&id=07304cda&scoped=true&\"\nimport script from \"./chat.vue?vue&type=script&lang=js&\"\nexport * from \"./chat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./chat.vue?vue&type=style&index=0&id=07304cda&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"07304cda\",\n  null\n  \n)\n\nexport default component.exports","module.exports = __webpack_public_path__ + \"assets/img/manf.png\";","module.exports = __webpack_public_path__ + \"assets/img/womans.png\";","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./chat.vue?vue&type=style&index=0&id=07304cda&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./chat.vue?vue&type=style&index=0&id=07304cda&lang=scss&scoped=true&\"","'use strict';\nvar $ = require('../internals/export');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar toInteger = require('../internals/to-integer');\nvar toLength = require('../internals/to-length');\nvar toObject = require('../internals/to-object');\nvar arraySpeciesCreate = require('../internals/array-species-create');\nvar createProperty = require('../internals/create-property');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('splice');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('splice', { ACCESSORS: true, 0: 0, 1: 2 });\n\nvar max = Math.max;\nvar min = Math.min;\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;\nvar MAXIMUM_ALLOWED_LENGTH_EXCEEDED = 'Maximum allowed length exceeded';\n\n// `Array.prototype.splice` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.splice\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT || !USES_TO_LENGTH }, {\n  splice: function splice(start, deleteCount /* , ...items */) {\n    var O = toObject(this);\n    var len = toLength(O.length);\n    var actualStart = toAbsoluteIndex(start, len);\n    var argumentsLength = arguments.length;\n    var insertCount, actualDeleteCount, A, k, from, to;\n    if (argumentsLength === 0) {\n      insertCount = actualDeleteCount = 0;\n    } else if (argumentsLength === 1) {\n      insertCount = 0;\n      actualDeleteCount = len - actualStart;\n    } else {\n      insertCount = argumentsLength - 2;\n      actualDeleteCount = min(max(toInteger(deleteCount), 0), len - actualStart);\n    }\n    if (len + insertCount - actualDeleteCount > MAX_SAFE_INTEGER) {\n      throw TypeError(MAXIMUM_ALLOWED_LENGTH_EXCEEDED);\n    }\n    A = arraySpeciesCreate(O, actualDeleteCount);\n    for (k = 0; k < actualDeleteCount; k++) {\n      from = actualStart + k;\n      if (from in O) createProperty(A, k, O[from]);\n    }\n    A.length = actualDeleteCount;\n    if (insertCount < actualDeleteCount) {\n      for (k = actualStart; k < len - actualDeleteCount; k++) {\n        from = k + actualDeleteCount;\n        to = k + insertCount;\n        if (from in O) O[to] = O[from];\n        else delete O[to];\n      }\n      for (k = len; k > len - actualDeleteCount + insertCount; k--) delete O[k - 1];\n    } else if (insertCount > actualDeleteCount) {\n      for (k = len - actualDeleteCount; k > actualStart; k--) {\n        from = k + actualDeleteCount - 1;\n        to = k + insertCount - 1;\n        if (from in O) O[to] = O[from];\n        else delete O[to];\n      }\n    }\n    for (k = 0; k < insertCount; k++) {\n      O[k + actualStart] = arguments[k + 2];\n    }\n    O.length = len - actualDeleteCount + insertCount;\n    return A;\n  }\n});\n","module.exports = __webpack_public_path__ + \"assets/img/mans.png\";"],"sourceRoot":""}