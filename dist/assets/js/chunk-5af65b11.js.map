{"version":3,"sources":["webpack:///./src/assets/fourth/womanf.png","webpack:///./src/views/first/childComp/chatinfo.vue?7920","webpack:///src/views/first/childComp/chatinfo.vue","webpack:///./src/views/first/childComp/chatinfo.vue?d448","webpack:///./src/views/first/childComp/chatinfo.vue","webpack:///./src/assets/fourth/manf.png","webpack:///./src/assets/fourth/womans.png","webpack:///./src/assets/fourth/mans.png","webpack:///./src/views/first/childComp/chatinfo.vue?7c91"],"names":["module","exports","render","_vm","this","_h","$createElement","_c","_self","staticClass","_l","item","index","key","_v","_s","time","type","attrs","imgbox","userInfo","headimg","src","content","$route","query","id","domProps","_e","on","softTe","model","value","callback","$$v","info","trim","expression","searchbtn","staticRenderFns","nmae","data","infobox","date","computed","methods","length","push","Date","toLocaleString","tel","histel","$socket","emit","scrollToBottom","localStorage","setItem","height","document","getElementsByClassName","style","setTimeout","getMsg","removeAllListeners","res","init","getItem","arr","JSON","parse","created","clearNewMsg","component"],"mappings":"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","file":"assets/js/chunk-5af65b11.js","sourcesContent":["module.exports = __webpack_public_path__ + \"assets/img/womanf.png\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"chatcontent\"},[_c('ul',_vm._l((_vm.infobox),function(item,index){return _c('li',{key:index},[_c('div',{staticClass:\"time\"},[_vm._v(_vm._s(item.time))]),(item.type === 0)?_c('div',{staticClass:\"mine_box\"},[_c('div',{staticClass:\"imgbox\"},[_c('img',{staticClass:\"img\",attrs:{\"src\":_vm.imgbox[_vm.userInfo.headimg || 0].src,\"alt\":\"\"}})]),_c('div',{staticClass:\"mine_msg\"},[_c('div',{staticClass:\"mine_info\"},[_vm._v(_vm._s(item.content))])])]):(item.type === 1)?_c('div',{staticClass:\"other_box\"},[_c('div',{staticClass:\"imgbox\"},[_c('img',{staticClass:\"img\",attrs:{\"src\":_vm.imgbox[_vm.$route.query.id.headimg  || 0].src,\"alt\":\"\"}})]),_c('div',{staticClass:\"other_msg\"},[_c('div',{staticClass:\"other_info\",domProps:{\"innerHTML\":_vm._s(item.content)}})])]):_vm._e()])}),0)]),_c('div',{staticClass:\"btn_btm\"},[_c('van-search',{staticClass:\"search_box\",attrs:{\"shape\":\"round\",\"left-icon\":\"chat\"},on:{\"focus\":_vm.softTe},model:{value:(_vm.info),callback:function ($$v) {_vm.info=(typeof $$v === 'string'? $$v.trim(): $$v)},expression:\"info\"}}),_c('van-button',{staticClass:\"search_btn\",attrs:{\"round\":\"\",\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":_vm.searchbtn}},[_vm._v(\"确定\")])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <div class=\"chatcontent\">\r\n      <ul>\r\n        <li v-for=\"(item, index) in infobox\" :key=\"index\">\r\n          <div class=\"time\">{{item.time}}</div>\r\n          <div class=\"mine_box\" v-if =\"item.type === 0\">\r\n            <div class=\"imgbox\">\r\n              <img :src=\"imgbox[userInfo.headimg || 0].src\" alt class=\"img\" />\r\n            </div>\r\n            <div class=\"mine_msg\">\r\n              <div class=\"mine_info\">{{item.content}}</div>\r\n            </div>\r\n          </div>\r\n          <div class=\"other_box\" v-else-if =\"item.type === 1\">\r\n            <div class=\"imgbox\">\r\n              <img :src=\"imgbox[$route.query.id.headimg  || 0].src\" alt class=\"img\" />\r\n            </div>\r\n            <div class=\"other_msg\">\r\n              <div class=\"other_info\" v-html=\"item.content\"></div>\r\n            </div>\r\n          </div>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n    <div class=\"btn_btm\">\r\n      <van-search v-model.trim=\"info\" shape=\"round\" left-icon=\"chat\" @focus=\"softTe\" class=\"search_box\" />\r\n      <van-button round type=\"primary\" size=\"small\" class=\"search_btn\" @click=\"searchbtn\">确定</van-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState, mapMutations } from 'vuex'\r\nimport { Toast } from 'vant'\r\nexport default {\r\n  nmae: \"chatinfo\",\r\n  data() {\r\n    return {\r\n      info: \"\",\r\n      infobox: [],\r\n      date: '',\r\n      imgbox: [\r\n        { id: 0, src: require(\"../../../assets/fourth/manf.png\") },\r\n        { id: 1, src: require(\"../../../assets/fourth/womanf.png\") },\r\n        { id: 2, src: require(\"../../../assets/fourth/mans.png\") },\r\n        { id: 3, src: require(\"../../../assets/fourth/womans.png\") }\r\n      ]\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapState([\"userInfo\"])\r\n  },\r\n  methods: {\r\n    ...mapMutations(['clearNewMsg','addNewMsg']),\r\n    searchbtn() {\r\n      if (this.info.length) {\r\n        this.infobox.push({\r\n          content:this.info,\r\n          time: new Date().toLocaleString(),\r\n          tel: this.userInfo.tel,\r\n          histel: this.$route.query.id.tel,\r\n          type: 0 // 0表示自己发送的信息，1表示自己接受到别人发送的信息\r\n        });\r\n        this.$socket.emit('sendMsg', {\r\n          content:this.info,\r\n          time: new Date().toLocaleString(),\r\n          tel: this.userInfo.tel,\r\n          histel: this.$route.query.id.tel,\r\n          type: 0\r\n        })\r\n        this.info = \"\"\r\n        if(this.$route.path == '/chatinfo') {\r\n          this.scrollToBottom();\r\n        }\r\n        localStorage.setItem(this.$route.query.id.tel,JSON.stringify(this.infobox))\r\n        var height = document.getElementsByClassName('chatcontent')[0].style.height\r\n        document.getElementsByClassName('chatcontent')[0].style.height = height - 50 +'px'\r\n      } else {\r\n        Toast('不能输入空值')\r\n      }\r\n    },\r\n    scrollToBottom: function() {\r\n      if(this.$route.path == '/chatinfo') {\r\n        setTimeout(function() {\r\n        var chatlist = document.getElementsByClassName(\"chatcontent\")[0];\r\n        chatlist.scrollTop = chatlist.scrollHeight || 0;\r\n        }, 100);\r\n      }\r\n    },\r\n    softTe() {\r\n      var height = document.getElementsByClassName('chatcontent')[0].style.height\r\n      document.getElementsByClassName('chatcontent')[0].style.height = height - 50 +'px'\r\n    },\r\n    getMsg() {\r\n      this.$socket.removeAllListeners('getMsg');\r\n      // 收到消息的时候\r\n      this.$socket.on('getMsg', res => {\r\n        if( this.$route.path == '/chatinfo' && this.$route.query.id.tel == res.tel ) {\r\n          if(res.histel === this.userInfo.tel ) {\r\n            res.type = 1\r\n            this.infobox.push(res)\r\n            localStorage.setItem(res.tel,JSON.stringify(this.infobox))\r\n            this.scrollToBottom()\r\n          }\r\n        }\r\n        //  else {\r\n        //   if(res.histel === this.userInfo.tel ) {\r\n        //     this.addNewMsg(res.tel)\r\n        //     res.type = 1\r\n        //     var infobg = JSON.parse(localStorage.getItem(res.tel)) || []\r\n        //     infobg.push(res)\r\n        //     localStorage.setItem(res.tel,JSON.stringify(infobg))\r\n        //   }\r\n        // }\r\n      })\r\n    },\r\n    init() {\r\n      var info = localStorage.getItem(this.$route.query.id.tel) || []\r\n      if(info.length > 0) {\r\n        var arr = JSON.parse(info)\r\n          if(arr.length > 30) {\r\n            var arrtwo = []\r\n            for(var i = arr.length - 30; i < arr.length; i++) {\r\n              arrtwo.push(arr[i])\r\n            }\r\n            this.infobox = arrtwo\r\n          } else {\r\n            this.infobox = arr\r\n          }\r\n          this.scrollToBottom();\r\n        }\r\n    }\r\n  },\r\n  created() {\r\n    this.clearNewMsg(this.$route.query.id.tel)\r\n    this.getMsg()\r\n    this.init()\r\n  },\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.content_app {\r\n  height: calc(100vh - 46px) !important;\r\n  background-color: rgb(225,230,219);\r\n}\r\n.chatcontent {\r\n  max-height: calc(100vh - 96px) !important;\r\n  overflow: scroll;\r\n}\r\n.btn_btm {\r\n  height: 50px;\r\n  position: fixed;\r\n  bottom: 0;\r\n  left:0;\r\n  right:0;\r\n  background-color: white;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  .search_box {\r\n    flex: 11;\r\n    margin-top: 5px;\r\n  }\r\n  .search_btn {\r\n    flex: 1;\r\n  }\r\n}\r\n.time{\r\n    text-align: center;\r\n    padding: 10px 0;\r\n    color: gray;\r\n    font-size: 12px;\r\n}\r\n.mine_box {\r\n  float: right;\r\n  width: 100%;\r\n  padding: 10px 0;\r\n  box-sizing: border-box;\r\n  .imgbox {\r\n    width: 40px;\r\n    height: 40px;\r\n    float: right;\r\n    .img {\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n  }\r\n  .mine_msg {\r\n    float: right;\r\n    margin-right: 10px;\r\n    width: 200px;\r\n    .mine_info {\r\n      float: right;\r\n      max-width: 200px;\r\n      min-height: 16px;\r\n      word-wrap: break-word;\r\n      padding: 10px;\r\n      border-radius: 5px;\r\n      position: relative;\r\n      border: 1px solid white;\r\n      background-color: white;\r\n    }\r\n  }\r\n}\r\n.mine_info:after {\r\n  content: \"\";\r\n  position: absolute;\r\n  right: -10px;\r\n  top: 15px;\r\n  width: 0;\r\n  height: 0;\r\n  border-style: solid dashed dashed;\r\n  border-color: white transparent transparent;\r\n  overflow: hidden;\r\n  border-width: 10px;\r\n}\r\n.other_box {\r\n  float: left;\r\n  width: 100%;\r\n  padding: 10px 0;\r\n  box-sizing: border-box;\r\n  .imgbox {\r\n    width: 40px;\r\n    height: 40px;\r\n    float: left;\r\n    .img {\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n  }\r\n  .other_msg {\r\n    float: left;\r\n    margin-left: 10px;\r\n    width: 200px;\r\n    .other_info {\r\n      float: left;\r\n      max-width: 200px;\r\n      min-height: 16px;\r\n      word-wrap: break-word;\r\n      padding: 10px;\r\n      border-radius: 5px;\r\n      position: relative;\r\n      border: 1px solid white;\r\n      background-color: white;\r\n    }\r\n  }\r\n}\r\n.other_info:after {\r\n  content: \"\";\r\n  position: absolute;\r\n  left: -10px;\r\n  top: 15px;\r\n  width: 0;\r\n  height: 0;\r\n  border-style: solid dashed dashed;\r\n  border-color: white transparent transparent;\r\n  overflow: hidden;\r\n  border-width: 10px;\r\n}\r\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./chatinfo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./chatinfo.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./chatinfo.vue?vue&type=template&id=2c304c4b&scoped=true&\"\nimport script from \"./chatinfo.vue?vue&type=script&lang=js&\"\nexport * from \"./chatinfo.vue?vue&type=script&lang=js&\"\nimport style0 from \"./chatinfo.vue?vue&type=style&index=0&id=2c304c4b&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2c304c4b\",\n  null\n  \n)\n\nexport default component.exports","module.exports = __webpack_public_path__ + \"assets/img/manf.png\";","module.exports = __webpack_public_path__ + \"assets/img/womans.png\";","module.exports = __webpack_public_path__ + \"assets/img/mans.png\";","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./chatinfo.vue?vue&type=style&index=0&id=2c304c4b&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./chatinfo.vue?vue&type=style&index=0&id=2c304c4b&lang=scss&scoped=true&\""],"sourceRoot":""}